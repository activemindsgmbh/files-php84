<?php require_once('_template_init.php'); ?>
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Artikelliste</title>
    <link rel="stylesheet" type="text/css" href="/default.css">
</head>
<body>
    <?php @include('header.inc.html') ?>

    <h2>Artikelliste</h2>

    <?php if (isset($success_message)): ?>
        <p class="success"><?php safe_echo($success_message) ?></p>
    <?php endif; ?>

    <?php if (isset($error_message)): ?>
        <p class="error"><?php safe_echo($error_message) ?></p>
    <?php endif; ?>

    <div class="actions">
        <a href="/artikeldaten.php" class="button">Neuen Artikel anlegen</a>
    </div>

    <?php if (is_valid_result($rartikel) && $rartikel->num_rows > 0): ?>
        <table>
            <tr>
                <th>Artikelnummer</th>
                <th>Artikeltext</th>
                <th>Preis</th>
                <th>Setup</th>
                <th>Umsatzsteuer</th>
                <th>Fibu Kontonummer</th>
                <th>Abrechnungsintervall</th>
                <th>Domains</th>
                <th>Domainregistrierung</th>
                <th>Aktionen</th>
            </tr>
            <?php while ($artikel = $rartikel->fetch_object()): ?>
                <tr>
                    <td>
                        <a href="/artikeldaten.php?id=<?php echo safe_url($artikel->id) ?>">
                            <?php safe_echo($artikel->artikelnummer) ?>
                        </a>
                    </td>
                    <td><?php safe_echo($artikel->kurztext) ?></td>
                    <td class="text-right"><?php safe_echo(number_format($artikel->preis, 2, ',', '.')) ?> €</td>
                    <td class="text-right">
                        <?php if (!empty($artikel->setup)): ?>
                            <?php safe_echo(number_format($artikel->setup, 2, ',', '.')) ?> €
                        <?php endif; ?>
                    </td>
                    <td class="text-right"><?php safe_echo($artikel->umsatzsteuer) ?> %</td>
                    <td class="text-right"><?php safe_echo($artikel->fibukonto) ?></td>
                    <td class="text-right"><?php safe_echo($artikel->intervall) ?></td>
                    <td class="text-right"><?php safe_echo($artikel->domains) ?></td>
                    <td class="text-center">
                        <?php if ($artikel->domainreg == 1): ?>
                            <span class="badge badge-success">Ja</span>
                        <?php endif; ?>
                    </td>
                    <td class="actions">
                        <a href="/artikeldaten.php?id=<?php echo safe_url($artikel->id) ?>" class="button button-small">
                            Bearbeiten
                        </a>
                        <a href="/artikel_loeschen.php?id=<?php echo safe_url($artikel->id) ?>" 
                           class="button button-small button-danger"
                           onclick="return confirm('Möchten Sie diesen Artikel wirklich löschen?');">
                            Löschen
                        </a>
                    </td>
                </tr>
            <?php endwhile; ?>
        </table>
    <?php else: ?>
        <p>Keine Artikel gefunden.</p>
    <?php endif; ?>
</body>
</html>
